<?php extend('../templates/main.html', ['title' => '25 Lessons']) ?>

<?php
// Page content here
// To include partials use:
// includePart('../parts/some-part.html', ['param'=>'value'])
?>

<h1 class="text-6xl text-center mb-8 font-display">25 Lessons</h1>

<h2 class="text-center text-xl max-w-screen-md mb-8 font-headline">Select lessons for notes &amp; links.</h2>

<div id="lessons-app" x-data="tflessons">

    <template x-if="!hasShowStarted()">
        <p class="mb-4 text-center">
            DEBUG: <button @click="debugStartTalk()">Start talk</button> | <button @click="debugEndTalk()">End
                talk</button>
        </p>
    </template>

    <ul id="lessons-grid" x-show="!hasShowEnded()"
        class="grid grid-cols-5 grid-rows-5 gap-1 justify-center items-center max-w-96 mx-auto">
        <template x-for="(lesson, index) in lessons" :key="lesson.id">
            <li class="lesson-card content-center aspect-square border border-black"
                :class="{ 'bg-black': isSelected(index), 'text-white': isSelected(index)}"
                @click="toggleSelected(index)">
                <h3 id="lesson-title" x-text="lesson.id" class="font-bold text-4xl text-center font-display">
                </h3>
            </li>
        </template>
    </ul>

    <template x-if="hasShowEnded()">
        <ul id="lessons-list" class="flex flex-col gap-2 max-w-96 mx-auto">
            <template x-for="(lesson, index) in lessons" :key="lesson.id">
                <li class="lesson-list-card flex border-2 border-black px-4 py-2"
                    :class="{ 'bg-black': isSelected(index), 'text-white': isSelected(index)}"
                    @click="toggleSelected(index)">
                    <h3 id="lesson-title" x-text="lesson.id + '.'"
                        class="w-16 flex-none font-bold text-4xl font-display">
                    </h3>
                    <p class="" x-text="lesson.title">
                    </p>
                </li>
            </template>
        </ul>
    </template>

    <div x-show="hasShowEnded()" class="flex gap-4 justify-center items-center">
        <button @click="showResources()" :disabled="!hasShowEnded()"
            class="block w-48 mt-6 bg-black  text-white px-4 py-3 font-headline font-bold text-xl focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white rounded transition duration-300 hover:bg-white hover:text-black disabled:bg-gray-300 disabled:text-gray-600">
            View resources
        </button>
        <button @click="showFeedback()" :disabled="!hasShowEnded()"
            class="block w-48 mt-6 bg-black  text-white px-4 py-3 font-headline font-bold text-xl focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white rounded transition duration-300 hover:bg-white hover:text-black disabled:bg-gray-300 disabled:text-gray-600">
            Leave feedback
        </button>
    </div>

    <p x-show="! hasShowEnded()" class="font-headline mt-6 text-center">
        You will be able to view and copy notes and links once the talk has ended.
    </p>

    <div id="resources" x-show="showingNotes" class="mt-12">
        <h2 class="text-3xl font-bold text-center mb-6">Your notes and links</h2>
        <div id="resources-sections" class="flex flex-col gap-3">
            <template x-for="(lesson, index) in lessons" :key="lesson.id">
                <template x-if="isSelected(index)">
                    <section class="lesson-notes-card flex border-2 border-black px-4 py-2">
                        <span id="lesson-title" x-text="lesson.id + '.'"
                            class="w-16 flex-none font-bold text-4xl font-display">
                        </span>
                        <div>
                            <h3 class="font-bold text-xl mb-4" x-text="lesson.title">
                            </h3>
                            <div class="lesson-description prose" x-html="marked.parse(lesson.description)"></div>
                        </div>
                    </section>
                </template>
            </template>
        </div>
    </div>

    <div id="resources" x-cloak x-show="showingFeedback" class="mt-12 w-full max-w-96 mx-auto ">
        <h2 class="text-2xl font-bold text-center mb-6 whitespace-nowrap">ðŸ”¥ Feedback is Fuel! ðŸ”¥</h2>
        <p class="text-center mb-6">Let me know what you think of this talk!<br>
            Be kind. Be genuine. Be specific.</p>
        <form @submit.prevent="submitFeedback">
            <textarea x-model="feedbackText" rows="12"
                class="bg-white rounded-xl overflow-hidden w-full mb-8 mt-0 border-none shadow-xl">

                </textarea>
            <label for="feedbackName" class="block text-center mb-4">Leave your name (optional)</label>
            <input name="feedbackName" type="text" x-model="feedbackName"
                class="bg-white rounded-xl overflow-hidden w-full mb-8 mt-0 border-none shadow-xl" />
            <button
                class="block w-48 mt-6 mx-auto bg-black text-center text-white px-4 py-3 font-headline font-bold text-xl focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white rounded transition duration-300 hover:bg-white hover:text-black disabled:bg-gray-300 disabled:text-gray-600"
                x-text="isFeedbackSubmitting ? 'Sending' : 'Send feedback'"
                :disabled="isFeedbackSubmitting || feedbackText.length < 3">
            </button>
        </form>
    </div>

    <button @click="copyResourcesToClipboard()" x-show="showingNotes"
        class="block mx-auto w-48 mt-6 bg-black  text-white px-4 py-3 font-headline font-bold text-xl focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white rounded transition duration-300 hover:bg-white hover:text-black disabled:bg-gray-300 disabled:text-gray-600"
        x-text="didJustCopy ? 'Copied' : 'Copy resources'">
    </button>


    <p x-show="shouldShowCopyNotice" class="font-headline mt-6 text-center">
        Markdown notes have been copied to your clipboard.<br>
        You can paste them into your notes/message/email app.
    </p>
</div>

<?php endExtend(); ?>
